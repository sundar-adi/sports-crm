{% extends "base/base.html" %}

{% load static %}

{% load wagtailcore_tags wagtailimages_tags %}

{% load article_tags %}

{% block page_background %}
<div>
  {% image tag.main_image original class="body-page-background" alt="" %}
</div>
{% endblock page_background %}

{% block content %}
<div class="uk-card uk-card-secondary">
  <div class="uk-card-header">
    <h2>{{ tag.name }}</h2>
    {% if tag.secondary_image %}{% image tag.secondary_image max-30x30 class="uk-hp-card-header__badge" alt="" %}{% endif %}
  </div>
  {% for article in articles %}
  <article class="uk-card-body">
    <h3 class="uk-card-title {% if forloop.first %}uk-card-title--important{% endif %}">{{article.title}}</h3>
    <p class="uk-flex uk-flex-between fw-medium uk-margin-small-top">
        <span>
          {% for author in article.authors.all %}
            <a href="" class="hp-link-primary">{{ author.first_name }} {{ author.last_name }}</a> {% if not forloop.last %}, {% endif %}
          {% empty %}
          HPTX
          {% endfor %}
          on {{ article.publication_date|date }}</span>
        <span>
          <span class="uk-margin-right">Views 8108</span>
          {% if homepage.has_social_links %}
          {% share article %}
          {% endif %}
        </span>
    </p>
    <div>
      {% if forloop.first and article.featured_image %}{% image article.featured_image original alt="" class="uk-hp-article-image" %}{% endif %}
      <div uk-grid class="uk-grid-small uk-margin-small-top">
        {% if not forloop.first %}
          {% with article.specific.get_verbose_name as page_type %}
            {% if page_type == "Article page" and article.featured_image %}
              <div class="uk-width-2-5">{% image article.featured_image original alt="" %}</div>
            {% elif page_type == "Video page" %}
              <div class="uk-width-2-5 uk-hp-card-primary-smallmedia">{{ article|youtube_block }}</div>
            {% elif page_type == "Podcast page" %}
              <div class="uk-width-1-4 uk-hp-card-primary-smallmedia">{{ article|soundcloud_block }}</div>
            {% endif %}
          {% endwith %}
        {% endif %}
        <div class="uk-width-expand uk-hp-card-primary-intro {% if not forloop.first and article|has_media %}uk-hp-card-primary-intro--has-media{% endif %}">
          <ellipsis>
            {{ article|first_paragraph_value }}
          </ellipsis>
        </div>
      </div>
    </div>
  </article>
  {% endfor %}
</div>
{% endblock %}
